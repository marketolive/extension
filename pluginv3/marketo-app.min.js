console.log("Marketo App > Running");window.mkto_live_plugin_state=true;var currentUrl=window.location.href,mktoAppDomain="^https:\/\/app-[a-z0-9]+\.marketo\.com",mktoAppMatch="https://app-*.marketo.com",mktoLoginDomain="^https:\/\/login\.marketo\.com",mktoAppLoginDomain="^https:\/\/app\.marketo\.com",mktoDesignerDomain="^https:\/\/[a-z0-9]+-[a-z0-9]+\.marketodesigner\.com",mktoDesignerMatch="https://*.marketodesigner.com/*",mktoEmailDesigner=mktoDesignerDomain+"/ds",mktoLandingPageDesigner=mktoDesignerDomain+"/lpeditor/",defaultTurnerLogoGreen="http://marketolive.com/m3/assets/img/turner-tech-green.png",defaultTurnerLogoWhite="http://marketolive.com/m3/assets/img/turner-tech-white.png",defaultColor="rgb(42, 83, 112)",mktoWizard=mktoAppDomain+"/m#",rtpDemoDomain="^http:\/\/sjrtp1.marketo.com\/demo\/$|^http:\/\/cloud4.insightera.com\/demo\/$",emailDeliverabilityDomain="^https:\/\/250ok.com/",mktoMyMarketoFragment="MM0A1",mktoMarketingActivitiesDefaultFragment="MA15A1",mktoLeadDatabaseDefaultFragment="ML0A1ZN2",mktoEmailDesignerFragment="EME",mktoEmailPreviewFragment="EMP",mktoLandingPageDesignerFragment="LPE",mktoLandingPagePreviewFragment="LPP",mktoFormWizardFragment="FOE",mktoMobilePushNotificationWizardFragment="MPNE",mktoSocialAppWizardFragment="SOAE",isMktoLiveInstance=false,pod,APP=APP||{};APP.getCookie=function(cookieField){console.log("Marketo App > Getting: Cookie "+cookieField);var name=cookieField+"=",cookies=document.cookie.split(';'),currentCookie;for(var ii=0;ii<cookies.length;++ii){var currentCookie=cookies[ii].trim();if(currentCookie.indexOf(name)==0){return currentCookie.substring(name.length,currentCookie.length);}}
return null;}
APP.disableDemoPluginCheck=function(){console.log("Marketo App > Disabling: Demo Plugin Check");MktPage.validateDemoPlugin=function(){};isMktoLiveInstance=true;}
APP.disableSystemErrorMessage=function(){console.log("Marketo App > Disabling: System Error Message");MktMessage.showSystemError=function(){};}
APP.overrideDeliverabilityToolsTile=function(){console.log("Marketo App > Overriding: Deliverability Tools Tile");var tiles=document.getElementsByTagName("a"),ii=0;for(ii=0;ii<tiles.length;++ii){if(tiles[ii].href.search("homepage/sso\\?sso=250ok")!=-1){tiles[ii].href="https://250ok.com/login";break;}}}
APP.enableSmartCampaignSaving=function(){console.log("Marketo App > Enabling: Saving for Smart Campaigns");Mkt.widgets.DataPanelManager.prototype.save=function(cause,dp,acceptUpdates){this._updateDataPanelOrder(true);if(this.saveQueue.blockingSaveInProgress){this.saveQueue.pendingChangesCount++;this.saveQueue.dataPanelMetas=this._serializeDataPanels();this.saveQueue.dataPanelCount=this.countDataPanels();return;}
var dataPanelMetas;if(this.saveQueue.dataPanelMetas){dataPanelMetas=this.saveQueue.dataPanelMetas;}
else{dataPanelMetas=this._serializeDataPanels();}
this.saveQueue.pendingChangesCount=0;this.saveQueue.dataPanelMetas=null;this.saveQueue.dataPanelCount=0;if(dataPanelMetas===null){return;}
if(dataPanelMetas.length===0&&this.isFlow){}
if(this.dpSubtype!=DPConst.RUN_ACTION&&dataPanelMetas){if(this.lastSave.dataPanelMetas&&this.lastSave.dataPanelMetas==dataPanelMetas){return;}
else if(this.lastSave.dataPanelMetasUpdated&&this.lastSave.dataPanelMetasUpdated==dataPanelMetas){return;}}
console.debug('Saving '+this.dpType+':',MktFormat.formatJsonStr(dataPanelMetas));if(DPDEBUG){console.debug('Current Save:',dataPanelMetas);if(this.lastSave.dataPanelMetas){console.debug('Previous Save:',this.lastSave.dataPanelMetas);}
if(this.lastSave.dataPanelMetasUpdated){console.debug('Previous Update:',this.lastSave.dataPanelMetasUpdated);}}
this.lastSave.acceptUpdates=acceptUpdates;this.lastSave.dataPanelMetas=dataPanelMetas;this.saveQueue.blockingSaveInProgress=true;this.beforeSaveMessage();var params=Ext.apply({dataPanelMetas:dataPanelMetas,accessZoneId:this.accessZoneId},this.baseSaveParams);if(this.isSmartlist&&this.smartListRuleLogic.customMode()){if(this.smartListRuleLogic.isCustomLogicValid()){var smartListLogicParams=this.smartListRuleLogic.getSmartListLogicSaveParams();Ext.apply(params,smartListLogicParams);}else{console.debug('Data panel save successful. Custom rule logic is not valid');}}
params[this.appVarsBase+'Id']=this.dataPanelStorageId;this.beforeSaveHook();if(DPDEBUG){console.debug("Saving... ",params);}
MktSession.ajaxRequest(this.saveAction,{serializeParms:params,onMySuccess:this.saveSuccess.createDelegate(this),onMyFailure:this.saveFailure.createDelegate(this)});}}
APP.disableSmartCampaignSaving=function(){console.log("Marketo App > Disabling: Saving for Smart Campaigns");Mkt.widgets.DataPanelManager.prototype.save=function(cause,dp,acceptUpdates){this._updateDataPanelOrder(true);}}
APP.enableSmartCampaignCanvas=function(){console.log("Marketo App > Enabling: Smart Campaign Canvases");Mkt.widgets.DataPanelLayout.prototype.initComponent=function(){this.dpEditable=true;DPDEBUG=false;if(this.dpSubtype){this.addClass('mktDataPanelLayout-'+this.dpSubtype);}
if(this.canvas){MktCanvas.mask(this.canvas);}
if(this.dpType=='Smartlist'){this.isSmartlist=true;this.Flow=false;this.SETTINGS='conditions';}
else if(this.dpType=='Flow'){this.isSmartlist=false;this.isFlow=true;this.SETTINGS='actions';}
this.items=[];this.items.push({region:'center',margins:!MktPage.isFeatureEnabled('carbolt')?'7 5 10 10':'',layout:'fit',items:this.createManager()});if(this.dpEditable&&this.canvas&&this.paletteWidth>0){this.canvasWidth=MktCanvas.getWidth();var availableWidth=Math.min(this.canvasWidth-700,this.maxPaletteWidth);this.paletteWidth=Math.max(this.paletteWidth,availableWidth);this.items.push({cls:'mktEastPanel',region:'east',margins:!MktPage.isFeatureEnabled('carbolt')?'5 5 5 8':'0 0 0 15',layout:'fit',width:this.paletteWidth,items:this.createPalette()});}
Mkt.widgets.DataPanelLayout.superclass.initComponent.apply(this);if(this.canvas){MktPage.canvasCleanupStack.push(this.canvasCleanup.createDelegate(this));}
if(this.canvas){this.extendCanvasToolbar();}
if(this.canvas){this.extendCanvasGutter();}
if(this.canvas){MktCanvas.addHook(this.canvas,{dp:this});}}}
APP.discardLandingPageDrafts=function(lpIds){console.log("Marketo App > Discarding: Landing Page Drafts");var lpMessageBox=Ext.MessageBox.show({title:"MarketoLive",msg:"Discarding Landing Page Drafts",progress:false,wait:false,width:270,closable:false});mktLPLManager.doModifyPages('revert',lpIds);lpMessageBox.hide();}
APP.discardEmailDrafts=function(emIds){console.log("Marketo App > Discarding: Email Drafts");var emMessageBox=Ext.MessageBox.show({title:"MarketoLive",msg:"Discarding Email Drafts",progress:false,wait:false,width:270,closable:false});mktEmManager.discardDraft(emIds);emMessageBox.hide();}
APP.discardFormPushDrafts=function(assetType,assetIds){console.log("Marketo App > Discarding: "+assetType+" Drafts");var assetStore=Ext4.getStore(assetType),originalExceptionFn=MktMessage.showSystemError;MktMessage.showSystemError=Ext4.emptyFn;if(typeof(Mkt3)!=='undefined'){if(!assetStore){assetStore=Ext4.create('Mkt3.store.'+assetType,{storeId:assetType});}
assetStore.load({filters:[{property:'id',value:assetIds}],callback:function(assets){for(var i=0;i<assets.length;i++){var asset=assets[i];asset.discard(function(success){if(success){asset.updateNode();}},this);}}});}}
APP.hideFolders=function(username){console.log("Marketo App > Hiding: Folders");var workspaces=document.getElementsByClassName("mkiEnvironment"),userWorkspace="Marketing",ii;for(ii=0;ii<workspaces.length;ii++){if(workspaces[ii].parentElement.getElementsByTagName("a")[0].getElementsByTagName("span")[0].innerHTML==userWorkspace){var folders=workspaces[ii].parentElement.parentElement.getElementsByTagName("ul")[0].getElementsByTagName("li"),jj;for(jj=0;jj<folders.length;jj++){if(folders[jj].getElementsByTagName("div")[0].getElementsByTagName("a")[0].getElementsByTagName("span")[0].innerHTML!=username){folders[jj].getElementsByTagName("div")[0].parentElement.setAttribute("style","display:none");}}
break;}}}
APP.disableButtons=function(){console.log("Marketo App > Disabling: Buttons");$jQ=jQuery.noConflict();$jQ(".mktButtonPositive").remove();}
APP.disableMenus=function(){console.log("Marketo App > Disabling: Menus");var prevMarketingNewEventMenu=Mkt.app.MarketingActivities.Toolbar.getNewEventMenuButton;Mkt.app.MarketingActivities.Toolbar.getNewEventMenuButton=function(){prevMarketingNewEventMenu.apply(this,arguments);return{text:MktLang.getStr('mktMaMenu.New'),iconCls:'mkiBooksBlue',xtype:'mkttbbutton',menu:MktMaMenu.maMenu(),handler:function(button){var canvas=MktCanvas.getActiveTab(),disableMenu=canvas&&canvas.config&&canvas.config.accessZoneId&&canvas.config.accessZoneId==1;button.menu.items.each(function(item){item.setDisabled(disableMenu);});}};}
var prevMarketingNewMenu=Mkt.app.MarketingActivities.Toolbar.getNewMenuButton;Mkt.app.MarketingActivities.Toolbar.getNewMenuButton=function(){prevMarketingNewMenu.apply(this,arguments);return{text:MktLang.getStr('mktMaMenu.New'),iconCls:'mkiBooksBlue',xtype:'mkttbbutton',menu:MktMaMenu.maMenu(),handler:function(button){var canvas=MktCanvas.getActiveTab(),disableMenu=canvas&&canvas.config&&canvas.config.accessZoneId&&canvas.config.accessZoneId==1;button.menu.items.each(function(item){item.setDisabled(disableMenu);});}};}
var prevDesignNewMenu=Mkt.app.DesignStudio.Toolbar.getNewMenuButton;Mkt.app.DesignStudio.Toolbar.getNewMenuButton=function(){prevDesignNewMenu.apply(this,arguments);return{text:MktLang.getStr('mktDsMenu.New'),iconCls:'mkiColorsCmyk',xtype:'mkttbbutton',menu:MktMaMenu.maMenu(),handler:function(button){var canvas=MktCanvas.getActiveTab(),disableMenu=canvas&&canvas.config&&canvas.config.accessZoneId&&canvas.config.accessZoneId==1;button.menu.items.each(function(item){item.setDisabled(disableMenu);});}};}
var prevActionsMenu=Mkt.menus.marketingEvent.Toolbar.preShowMarketingProgramActions;Mkt.menus.marketingEvent.Toolbar.preShowMarketingProgramActions=Mkt.menus.marketingEvent.Toolbar.preShowMarketingEventActions=function(menu){prevActionsMenu.apply(this,arguments);var mItems=menu.items,canvas=MktCanvas.getActiveTab(),disable=canvas&&canvas.config&&canvas.config.accessZoneId&&canvas.config.accessZoneId==1,itemsToDisable=["cloneMarketingProgram","cloneMarketingEvent","cloneNurtureProgram","cloneEmailBatchProgram","deleteMarketingProgram","deleteMarketingEvent","deleteNurtureProgram","deleteEmailBatchProgram","testNurtureProgram","eventSchedule","entryRescheduleEntries","sfdcCampaignSync","refreshFromWebinarProvider",];itemsToDisable.forEach(function(itemToDisable){var item=mItems.get(itemToDisable);if(item){item.setDisabled(disable);}});}
var prevRightClickMenu=MktMaMenu.preShowProgramActionsMenu;MktMaMenu.preShowProgramActionsMenu=function(menu,attr){prevRightClickMenu.apply(this,arguments);var mItems=menu.items,canvas=MktCanvas.getActiveTab(),disable=attr.accessZoneId==1||!attr.accessZoneId&&canvas&&canvas.config&&canvas.config.accessZoneId&&canvas.config.accessZoneId==1,itemsToDisable=["newSmartCampaign","newLocalAsset","createNewMarketingProgram","createProgramFolder","renameProgramFolder","deleteProgramFolder","convertToArchiveFolder","convertToCampaignFolder","scClone","cloneMarketingProgram","cloneMarketingEvent","cloneNurtureProgram","cloneEmailBatchProgram","scArchive","deleteMarketingProgram","deleteMarketingEvent","deleteNurtureProgram","deleteEmailBatchProgram","scMove","scActivate","scAbort","scClearPalette","scClearSmartList","scClearFlow","shareProgramFolder","progGenerateRef","checkForCorruptEmails"];itemsToDisable.forEach(function(itemToDisable){var item=mItems.get(itemToDisable);if(item){item.setDisabled(disable);}});return menu;}
var prevEmailRightClickMenu=MktDsMenu.preShowEmailMenu;MktDsMenu.preShowEmailMenu=function(menu,attr){prevEmailRightClickMenu.apply(this,arguments);var mItems=menu.items,canvas=MktCanvas.getActiveTab(),disable=attr.accessZoneId==1||!attr.accessZoneId&&canvas&&canvas.config&&canvas.config.accessZoneId&&canvas.config.accessZoneId==1,itemsToDisable=["emailApprove","emailUnapprove","emailClone","emailDelete","emailMove","emailNewTest","emailDraftSendTest","emailDraftApprove","emailApproveTest","emailDiscardTest"];itemsToDisable.forEach(function(itemToDisable){var item=mItems.get(itemToDisable);if(item){item.setDisabled(disable);}});return menu;}
var prevLandingPageRightClickMenu=MktDsMenu.preShowPageMenu;MktDsMenu.preShowPageMenu=function(menu,attr){prevLandingPageRightClickMenu.apply(this,arguments);var mItems=menu.items,canvas=MktCanvas.getActiveTab(),disable=attr.accessZoneId==1||!attr.accessZoneId&&canvas&&canvas.config&&canvas.config.accessZoneId&&canvas.config.accessZoneId==1,itemsToDisable=["pageApprove","pageUnapprove","pageConvertToTestGroup","pageClone","pageDelete","urlTools","pageMove","pageDraftApprove",];itemsToDisable.forEach(function(itemToDisable){var item=mItems.get(itemToDisable);if(item){item.setDisabled(disable);}});return menu;}
var prevFormRightClickMenu=MktDsMenu.preShowFormMenu;MktDsMenu.preShowFormMenu=function(menu,attr){prevFormRightClickMenu.apply(this,arguments);var mItems=menu.items,canvas=MktCanvas.getActiveTab(),disable=attr.accessZoneId==1||!attr.accessZoneId&&canvas&&canvas.config&&canvas.config.accessZoneId&&canvas.config.accessZoneId==1,itemsToDisable=["formApprove","formClone","formDelete","formMove","formDraftApprove",];itemsToDisable.forEach(function(itemToDisable){var item=mItems.get(itemToDisable);if(item){item.setDisabled(disable);}});return menu;}
var prevSocialAppRightClickMenu=MktDsMenu.preShowSocialAppMenu;MktDsMenu.preShowSocialAppMenu=function(menu,attr){prevSocialAppRightClickMenu.apply(this,arguments);var mItems=menu.items,canvas=MktCanvas.getActiveTab(),disable=attr.accessZoneId==1||!attr.accessZoneId&&canvas&&canvas.config&&canvas.config.accessZoneId&&canvas.config.accessZoneId==1,itemsToDisable=["socialAppApprove","socialAppClone","socialAppDelete","socialAppDraftApprove",];itemsToDisable.forEach(function(itemToDisable){var item=mItems.get(itemToDisable);if(item){item.setDisabled(disable);}});return menu;}
var prevSocialAppActionsMenu=Mkt3.controller.socialApp.SocialApp.prototype.loadToolbar;Mkt3.controller.socialApp.SocialApp.prototype.loadToolbar=function(menu,attr){prevSocialAppActionsMenu.apply(this,arguments);var disable=this.getSocialApp().get('zoneId')==1,mItems=Ext4.ComponentQuery.query("socialAppToolbar contextMenu [action=approve],"+"socialAppToolbar contextMenu [action=clone],"+"socialAppToolbar contextMenu [action=delete],"+"socialAppToolbar contextMenu [action=editDraft],"+"socialAppToolbar contextMenu [action=previewDraft],"+"socialAppToolbar contextMenu [action=approveDraft],");mItems.forEach(function(item){if(item){item.setDisabled(disable);}});return menu;}
var prevPushNotificationRightClickMenu=MktDsMenu.preShowPushNotificationMenu;MktDsMenu.preShowPushNotificationMenu=function(menu,attr){prevPushNotificationRightClickMenu.apply(this,arguments);var mItems=menu.items,canvas=MktCanvas.getActiveTab(),disable=attr.accessZoneId==1||!attr.accessZoneId&&canvas&&canvas.config&&canvas.config.accessZoneId&&canvas.config.accessZoneId==1,itemsToDisable=["pushNotificationApprove","pushNotificationUnapprove","pushNotificationDelete","pushNotificationDraftEdit","pushNotificationDraftSendSample","pushNotificationDraftApprove",];itemsToDisable.forEach(function(itemToDisable){var item=mItems.get(itemToDisable);if(item){item.setDisabled(disable);}});return menu;}
var prevPushNotificationActionsMenu=Mkt3.controller.mobilePushNotification.MobilePushNotification.prototype.loadToolbar;Mkt3.controller.mobilePushNotification.MobilePushNotification.prototype.loadToolbar=function(menu,attr){prevPushNotificationActionsMenu.apply(this,arguments);var disable=this.getMobilePushNotification().get('zoneId')==1,mItems=Ext4.ComponentQuery.query("mobilePushNotification contextMenu [action=approve],"+"mobilePushNotification contextMenu [action=unapprove],"+"mobilePushNotification contextMenu [action=clone],"+"mobilePushNotification contextMenu [action=delete],"+"mobilePushNotification contextMenu [action=editDraft],"+"mobilePushNotification contextMenu [action=sendDraftSample],"+"mobilePushNotification contextMenu [action=approveDraft],");mItems.forEach(function(item){if(item){item.setDisabled(disable);}});return menu;}
var prevDesignStudioContextMenu=MktDsMenu.preShowContextMenu;MktDsMenu.preShowContextMenu=function(menu,attr){prevDesignStudioContextMenu.apply(this,arguments);var mItems=menu.items,canvas=MktCanvas.getActiveTab(),disable=attr.accessZoneId==1||!attr.accessZoneId&&canvas&&canvas.config&&canvas.config.accessZoneId&&canvas.config.accessZoneId==1,itemsToDisable=["newLandingPage","newTestGroup","newPageTemplate","pageTemplateImport","newForm","newVideoShare","newShareButton","newReferralOffer","newEmail","newEmailTemplate","newSnippet","uploadImage","share","createFolder","renameFolder","deleteFolder","convertToArchiveFolder","convertToFolder",];itemsToDisable.forEach(function(itemToDisable){var item=mItems.get(itemToDisable);if(item){item.setDisabled(disable);}});return menu;}
var prevLandingPageTemplateMenu=MktDsMenu.preShowTemplateMenu;MktDsMenu.preShowTemplateMenu=function(menu,attr){prevLandingPageTemplateMenu.apply(this,arguments);var mItems=menu.items,canvas=MktCanvas.getActiveTab(),disable=attr.accessZoneId==1||!attr.accessZoneId&&canvas&&canvas.config&&canvas.config.accessZoneId&&canvas.config.accessZoneId==1,itemsToDisable=["approvePageTemplate","unapprovePageTemplate","clonePageTemplate","pageTemplateDelete","approveDraftPageTemplate",];itemsToDisable.forEach(function(itemToDisable){var item=mItems.get(itemToDisable);if(item){item.setDisabled(disable);}});return menu;}
var prevEmailTemplateMenu=MktDsMenu.preShowEmailTemplateMenu;MktDsMenu.preShowEmailTemplateMenu=function(menu,attr){prevEmailTemplateMenu.apply(this,arguments);var mItems=menu.items,canvas=MktCanvas.getActiveTab(),disable=attr.accessZoneId==1||!attr.accessZoneId&&canvas&&canvas.config&&canvas.config.accessZoneId&&canvas.config.accessZoneId==1,itemsToDisable=["emailTemplateApprove","emailTemplateUnapprove","emailTemplateClone","emailTemplateDelete","emailTemplateDraftSendTest","emailTemplateDraftApprove",];itemsToDisable.forEach(function(itemToDisable){var item=mItems.get(itemToDisable);if(item){item.setDisabled(disable);}});return menu;}
var prevSnippetMenu=MktDsMenu.preShowSnippetMenu;MktDsMenu.preShowSnippetMenu=function(menu,attr){prevSnippetMenu.apply(this,arguments);var mItems=menu.items,canvas=MktCanvas.getActiveTab(),disable=attr.accessZoneId==1||!attr.accessZoneId&&canvas&&canvas.config&&canvas.config.accessZoneId&&canvas.config.accessZoneId==1,itemsToDisable=["snippetApprove","snippetUnapprove","snippetClone","snippetDelete","snippetDraftApprove",];itemsToDisable.forEach(function(itemToDisable){var item=mItems.get(itemToDisable);if(item){item.setDisabled(disable);}});return menu;}
var prevImageMenu=MktDsMenu.preShowImageMenu;MktDsMenu.preShowImageMenu=function(menu,attr){prevImageMenu.apply(this,arguments);var mItems=menu.items,canvas=MktCanvas.getActiveTab(),disable=attr.accessZoneId==1||!attr.accessZoneId&&canvas&&canvas.config&&canvas.config.accessZoneId&&canvas.config.accessZoneId==1,itemsToDisable=["uploadImage","imageDelete","replaceImage",];itemsToDisable.forEach(function(itemToDisable){var item=mItems.get(itemToDisable);if(item){item.setDisabled(disable);}});return menu;}
var prevLeadDatabaseContextMenu=MktLeadDbMenu.preShowContextMenu;MktLeadDbMenu.preShowContextMenu=function(menu,attr){prevLeadDatabaseContextMenu.apply(this,arguments);var mItems=menu.items,canvas=MktCanvas.getActiveTab(),disable=menu.currNode&&menu.currNode.attributes&&menu.currNode.attributes.accessZoneId==1||!menu.currNode&&canvas&&canvas.config&&canvas.config.accessZoneId&&canvas.config.accessZoneId==1,itemsToDisable=["cloneSmartlist","cloneList","deleteList","showSupportHistory","showSupportUsagePerf","showSmartListProcessorDiag","showSmartListProcessorOverride",];itemsToDisable.forEach(function(itemToDisable){var item=mItems.get(itemToDisable);if(item){item.setDisabled(disable);}});return menu;}
var prevListMenu=MktLeadDbMenu.preShowListListMenu;MktLeadDbMenu.preShowListListMenu=function(menu,attr){prevListMenu.apply(this,arguments);debugger;var mItems=menu.items,canvas=MktCanvas.getActiveTab(),disable=menu.currNode&&menu.currNode.attributes&&menu.currNode.attributes.accessZoneId==1||!menu.currNode&&canvas&&canvas.config&&canvas.config.accessZoneId&&canvas.config.accessZoneId==1,itemsToDisable=["cloneSmartlist","cloneList","deleteList","showSupportHistory","showSupportUsagePerf","showSmartListProcessorDiag","showSmartListProcessorOverride",];itemsToDisable.forEach(function(itemToDisable){var item=mItems.get(itemToDisable);if(item){item.setDisabled(disable);}});return menu;}
var prevSegmentationMenu=MktLeadDbMenu.preShowSegmentationMenu;MktLeadDbMenu.preShowSegmentationMenu=function(menu,attr){prevSegmentationMenu.apply(this,arguments);var mItems=menu.items,canvas=MktCanvas.getActiveTab(),disable=menu.currNode&&menu.currNode.attributes&&menu.currNode.attributes.accessZoneId==1||!menu.currNode&&canvas&&canvas.config&&canvas.config.accessZoneId&&canvas.config.accessZoneId==1,itemsToDisable=["createDraftSegmentation","approveSegmentation","unapproveSegmentation","deleteSegmentation","approveDraftSegmentation",];itemsToDisable.forEach(function(itemToDisable){var item=mItems.get(itemToDisable);if(item){item.setDisabled(disable);}});return menu;}
var prevSegmentationFolderMenu=MktLeadDbMenu.preShowSegmentationFolderMenu;MktLeadDbMenu.preShowSegmentationFolderMenu=function(menu,attr){prevSegmentationFolderMenu.apply(this,arguments);var mItems=menu.items,canvas=MktCanvas.getActiveTab(),disable=menu.currNode&&menu.currNode.attributes&&menu.currNode.attributes.accessZoneId==1||!menu.currNode&&canvas&&canvas.config&&canvas.config.accessZoneId&&canvas.config.accessZoneId==1,itemsToDisable=["newSegmentation","share","createFolder","renameFolder","deleteFolder","convertToArchiveFolder","convertToFolder",];itemsToDisable.forEach(function(itemToDisable){var item=mItems.get(itemToDisable);if(item){item.setDisabled(disable);}});return menu;}
var prevSmartListMenu=MktLeadDbMenu.preShowUserListMenu;MktLeadDbMenu.preShowUserListMenu=function(menu,attr){prevSmartListMenu.apply(this,arguments);var mItems=menu.items,canvas=MktCanvas.getActiveTab(),disable=menu.currNode&&menu.currNode.attributes&&menu.currNode.attributes.accessZoneId==1||!menu.currNode&&canvas&&canvas.config&&canvas.config.accessZoneId&&canvas.config.accessZoneId==1,itemsToDisable=["cloneSmartlist","cloneList","deleteList",];itemsToDisable.forEach(function(itemToDisable){var item=mItems.get(itemToDisable);if(item){item.setDisabled(disable);}});return menu;}
var prevReportMenu=MktAnalyticsMenu.preShowReportMenu;MktAnalyticsMenu.preShowReportMenu=function(menu,attr){prevReportMenu.apply(this,arguments);var mItems=menu.items,canvas=MktCanvas.getActiveTab(),disable=menu.currNode&&menu.currNode.attributes&&menu.currNode.attributes.accessZoneId==1||!menu.currNode&&canvas&&canvas.config&&canvas.config.accessZoneId&&canvas.config.accessZoneId==1,itemsToDisable=["cloneReport","deleteReport","moveReport",];itemsToDisable.forEach(function(itemToDisable){var item=mItems.get(itemToDisable);if(item){item.setDisabled(disable);}});return menu;}
var prevReportFolderMenu=MktAnalyticsMenu.preshowReportFolderMenu;MktAnalyticsMenu.preshowReportFolderMenu=function(menu,attr){prevReportFolderMenu.apply(this,arguments);var mItems=menu.items,canvas=MktCanvas.getActiveTab(),disable=menu.currNode&&menu.currNode.attributes&&menu.currNode.attributes.accessZoneId==1||!menu.currNode&&canvas&&canvas.config&&canvas.config.accessZoneId&&canvas.config.accessZoneId==1,itemsToDisable=["createFolder","renameFolder","deleteFolder","convertToArchiveFolder","convertToFolder","newRcm","share","moveReport",];itemsToDisable.forEach(function(itemToDisable){var item=mItems.get(itemToDisable);if(item){item.setDisabled(disable);}});return menu;}}
APP.limitNurturePrograms=function(){console.log("Marketo App > Limiting: Nurture Programs");var previousMarketingEventForm=Mkt.apps.marketingEvent.MarketingEventForm.prototype.beforeSubmitCallback;Mkt.apps.marketingEvent.MarketingEventForm.prototype.beforeSubmitCallback=function(){var limit_exceeded=false,rootNode=MktExplorer.boundTree.root,compType="Nurture Program",matches=[],node=rootNode.cascade(function(){var attr=this.attributes;if(attr&&attr.xtra){if(attr.xtra.compType==compType&&attr.xtra.accessZoneId==MktCanvas.activeTab.config.accessZoneId){matches.push(this);}}},undefined,[compType]);if(matches.length>=3){limit_exceeded=true;}
if(limit_exceeded==true){var nutureProgramMessageBox=Ext.MessageBox.show({title:"MarketoLive",msg:"Individual workspaces are limited to 3 nurture programs.",width:400,closable:true});nutureProgramMessageBox.show;return false;}else{return previousMarketingEventForm.apply(this,arguments);}}}
APP.injectAnalyzerNavBar=function(){var isPodsLoaded=window.setInterval(function(){if(typeof(PODS)!=="undefined"){console.log("Marketo App > Injecting: Analyzer Navigation Bar");window.clearInterval(isPodsLoaded);if(typeof(pod)=="undefined"){pod=new PODS.Pod(PODS.getCookie("userPod"));}
for(var y=0;y<pod.valueSet.length;y++){if(currentUrl==pod.valueSet[y].url){console.log("Marketo App > Updating: CSS for Analyzer Navigation Bar");$j=jQuery.noConflict();var currPosition='#'+pod.valueSet[y].position;$j(currPosition).parent().css('display','block');$j(currPosition).parent().siblings().css('display','none');$j(currPosition).removeClass('analyzer-button').addClass('analyzer-title');$j(currPosition).siblings().removeClass('analyzer-title').addClass('analyzer-button');$j("#modeler,#success-path-analyzer,#opportunity-influence-analyzer,#program-analyzer").bind("click",function(e){console.log("Marketo App > Identifying: Current Analyzer");for(var x=0;x<pod.valueSet.length;x++){if(e.target.id==pod.valueSet[x].position)
currPosition=x;}
window.location=pod.valueSet[currPosition].url;});}}}},0);}
APP.enableSaving=function(){console.log("Marketo App > Enabling: Saving for Editors & Nurture Streams");Mkt3.data.Store.prototype.sync=function(){if(this.autoSyncSuspended){this.autoSync=true;this.autoSyncSuspended=false;}
if(this.getProxy()instanceof Mkt3.data.proxy.AjaxPost){Mkt3.Synchronizer.sync(this);}else{this.callParent(arguments);}}
Ext4.data.Model.prototype.destroy=function(options){options=Ext.apply({records:[this],action:'destroy'},options);var me=this,isNotPhantom=me.phantom!==true,scope=options.scope||me,stores=me.stores,i=0,storeCount,store,args,operation,callback;operation=new Ext.data.Operation(options);callback=function(operation){args=[me,operation];if(operation.wasSuccessful()){for(storeCount=stores.length;i<storeCount;i++){store=stores[i];store.remove(me,true);if(isNotPhantom){store.fireEvent('write',store,operation);}}
me.clearListeners();Ext.callback(options.success,scope,args);}else{Ext.callback(options.failure,scope,args);}
Ext.callback(options.callback,scope,args);};if(isNotPhantom){me.getProxy().destroy(operation,callback,me);}else{operation.complete=operation.success=true;operation.resultSet=me.getProxy().reader.nullResultSet;callback(operation);}
return me;}}
APP.disableSaving=function(){console.log("Marketo App > Disabling: Saving for Editors & Nurture Streams");Mkt3.data.Store.prototype.sync=function(){};Ext4.data.Model.prototype.destroy=function(){};Mkt3.controller.editor.form.settings.FieldSelection.prototype.deleteFormField=function(formField){var formFieldWidget=formField.getFieldWidget(),formFieldId,childFieldIndex,childFormField,allFormFields;if(formFieldWidget&&formFieldWidget.get('datatype')==='fieldset'){allFormFields=this.getForm().getFormFields();formFieldId=formField.get('id');for(childFieldIndex=0;childFieldIndex<allFormFields.getCount();childFieldIndex++){childFormField=allFormFields.getAt(childFieldIndex);if(childFormField.get('fieldsetFieldId')==formFieldId){this.deleteFormField(childFormField);}}}
formField.destroy({scope:this,callback:function(field,response){if(response.success){if(formFieldWidget){formFieldWidget.destroy();}}}});this.renumberWidgets();}}
APP.overlayEmailDesigner=function(){console.log("Marketo App > Overlaying: Email Designer");var logo=APP.getCookie("logo"),color=APP.getCookie("color");if(logo==null){logo=defaultTurnerLogoWhite;}
if(color==null){color=defaultColor;}
var isIframeElement=window.setInterval(function(){var logoBkg=document.getElementsByTagName("iframe")[0].contentWindow.document.getElementById("logo-bkg"),buttonBkg=document.getElementsByTagName("iframe")[0].contentWindow.document.getElementById("button-bkg"),logoSwapCompany=document.getElementsByTagName("iframe")[0].contentWindow.document.getElementById("logo-swap-company"),logoSwapContainer=document.getElementsByTagName("iframe")[0].contentWindow.document.getElementById("logo-swap-container"),logoSwapCompanyContainer=document.getElementsByTagName("iframe")[0].contentWindow.document.getElementById("logo-swap-company-container");if(logoBkg!=null&&buttonBkg!=null&&logoSwapCompany!=null){console.log("Marketo App > Overlaying: iframe");logoSwapContainer.style.display="none";logoSwapCompanyContainer.style.display="block";logoBkg.style.backgroundColor=color;buttonBkg.style.backgroundColor=color;logoSwapCompany.src=logo;window.clearInterval(isIframeElement);}},0);}
APP.overlayLandingPageDesigner=function(){console.log("Marketo App > Overlaying: Landing Page Designer");var logo=APP.getCookie("logo"),color=APP.getCookie("color");if(logo==null){logo=defaultTurnerLogoGreen;}
if(color==null){color=defaultColor;}
var isIframeElement=window.setInterval(function(){var lpLogo=document.getElementsByTagName("iframe")[0].contentWindow.document.getElementById("lp-logo"),backgroundColor=document.getElementsByTagName("iframe")[0].contentWindow.document.getElementById("background-color"),biggerBackground=document.getElementsByTagName("iframe")[0].contentWindow.document.getElementById("bigger-background"),subTitle=document.getElementsByTagName("iframe")[0].contentWindow.document.getElementById("sub-title");if(lpLogo!=null&&backgroundColor!=null&&biggerBackground!=null&&subTitle!=null){console.log("Marketo App > Overlaying: iframe");lpLogo.src=logo;backgroundColor.style.backgroundColor=color;biggerBackground.style.backgroundColor=color;subTitle.innerHTML=companyName+" invites you to join:";window.clearInterval(isIframeElement);}},0);}
APP.getEmailIds=function(pod){console.log("Marketo App > Getting Email Ids for Pod: "+pod);var emIds=[];switch(pod){case"app-sjp":emIds.push(15464);emIds.push(12818,12820,12819,12816,12811,12815,12812,12821,12813,12814,12817,12823);emIds.push(10010,10179,10180,12845,10181,10182,10183,10184);emIds.push(4894,3764,3765,3767,3766,3762);break;case"app-ab07":emIds.push(14240);emIds.push(10171,10173,10172,10169,9957,9974,9968,10174,9972,9973,10170,9962);emIds.push(10010,10179,10180,10181,10182,10183,10184);emIds.push(4894,3764,3765,3767,3766,3762);break;case"app-ab08":emIds.push(13924);emIds.push(12818,12820,12819,12816,12811,12815,12812,12821,12813,12814,12817,12823);emIds.push(10010,10179,10180,12845,10181,10182,10183,10184);emIds.push(4894,3764,3765,3767,3766,3762);break;default:console.error("Marketp App > Invalid: User Pod in getEmailIds()");break;}
return emIds;}
if(currentUrl.search(mktoAppDomain)!=-1||currentUrl.search(mktoDesignerDomain)!=-1||currentUrl.search(mktoWizard)!=-1){console.log("Marketo App > Location: Marketo URL");var isMktPageApp=window.setInterval(function(){if(typeof(MktPage)!=="undefined"){console.log("Marketo App > Location: Marketo Page");window.clearInterval(isMktPageApp);var accountString=MktPage.savedState.custPrefix,userId=MktPage.userid,username=userId.split("@")[0];if(accountString.search("^mktodemoaccount")!=-1&&(userId.search("\.demo@marketo\.com$")!=-1||userId.search("^admin@mktodemoaccount")!=-1||userId.search("^mktodemoaccount[a-z0-9]*@marketo\.com")!=-1)){console.log("Marketo App > Location: MarketoLive Instance");if(userId.search("^admin@mktodemoaccount")!=-1||userId.search("^mktodemoaccount[a-z0-9]*@marketo\.com")!=-1){console.log("Marketo App > User: Admin");APP.disableDemoPluginCheck();if(APP.getCookie("priv")!="false"){return;}
else{console.log("Marketo App > User: Admin is now a normal user");}}
var currUrlFragment,prevWorkspaceId,oppInfluenceAnalyzerFragment="AR1559A1!",programAnalyzerFragment="AR1544A1!",modeler106Fragment="RCM39A1!",modeler106abFragment="RCM5A1!",successPathAnalyzerFragment="AR1682A1!";APP.disableDemoPluginCheck();currUrlFragment=Mkt3.DL.getDlToken();if(currUrlFragment==mktoMyMarketoFragment){APP.overrideDeliverabilityToolsTile();}
else if(currUrlFragment==mktoMarketingActivitiesDefaultFragment||currUrlFragment==mktoLeadDatabaseDefaultFragment){APP.disableButtons();}
if(currUrlFragment.search("^"+mktoEmailDesignerFragment)==-1&&currUrlFragment.search("^"+mktoEmailPreviewFragment)&&currUrlFragment.search("^"+mktoLandingPageDesignerFragment)==-1&&currUrlFragment.search("^"+mktoLandingPagePreviewFragment)==-1&&currUrlFragment.search("^"+mktoFormWizardFragment)==-1&&currUrlFragment.search("^"+mktoMobilePushNotificationWizardFragment)==-1&&currUrlFragment.search("^"+mktoSocialAppWizardFragment)==-1){if(currUrlFragment!=mktoMyMarketoFragment){var isMktCanvas=window.setInterval(function(){if(MktCanvas.activeTab!==null){console.log("Marketo App > Location: Marketo Canvas");window.clearInterval(isMktCanvas);prevWorkspaceId=MktCanvas.activeTab.config.accessZoneId;if(prevWorkspaceId==1){APP.disableSmartCampaignSaving();APP.enableSmartCampaignCanvas();APP.disableSaving();}}},0);var isMktTree=window.setInterval(function(){if(typeof(Mkt.widgets.FilterTreePanel.prototype.updateTreeWidth)!=="undefined"){console.log("Marketo App > Location: Marketo Tree");window.clearInterval(isMktTree);APP.hideFolders(username);}},0);}
if(currUrlFragment==oppInfluenceAnalyzerFragment||currUrlFragment==programAnalyzerFragment||currUrlFragment==modeler106Fragment||currUrlFragment==modeler106abFragment||currUrlFragment==successPathAnalyzerFragment){console.log("Marketo App > Location: Analytics");APP.injectAnalyzerNavBar();}
var lpIds={},formIds=[],pushIds=[],emIds=APP.getEmailIds(APP.getCookie("userPod"));switch(accountString){case"mktodemoaccount106":lpIds["dpageid_11381"]="dpageid_11381";lpIds["dpageid_11291"]="dpageid_11291";formIds.push(2892,1749,1900);pushIds.push(29,23);break;case"mktodemoaccount106a":lpIds["dpageid_10672"]="dpageid_10672";lpIds["dpageid_10454"]="dpageid_10454";formIds.push(2532,1749,1900);pushIds.push(29,26);break;case"mktodemoaccount106b":lpIds["dpageid_10760"]="dpageid_10768";lpIds["dpageid_10762"]="dpageid_10762";formIds.push(2472,1749,1900);pushIds.push(2,1);break;default:break;}
var canDiscardDrafts=window.setInterval(function(){if(typeof(mktLPLManager)!=="undefined"){window.clearInterval(canDiscardDrafts);APP.discardLandingPageDrafts(lpIds);APP.discardEmailDrafts(emIds);APP.discardFormPushDrafts("Form",formIds);APP.discardFormPushDrafts("MobilePushNotification",pushIds);APP.limitNurturePrograms();APP.disableMenus();}},0);}
else if(currUrlFragment.search("^"+mktoLandingPageDesignerFragment)!=-1){console.log("Marketo App > Location: Landing Page Designer");var customCompanyLandingPage106Fragment="LPE11381",customCompanyLandingPagePreview106Fragment="LPP11381",customCompanyLandingPage106aFragment="LPE10672",customCompanyLandingPagePreview106aFragment="LPP10672",customCompanyLandingPage106bFragment="LPE10768",customCompanyLandingPagePreview106bFragment="LPP10768";APP.disableSystemErrorMessage();switch(currUrlFragment){case customCompanyLandingPage106Fragment:APP.overlayLandingPageDesigner();break;case customCompanyLandingPagePreview106Fragment:APP.overlayLandingPageDesigner();break;case customCompanyLandingPage106aFragment:APP.overlayLandingPageDesigner();break;case customCompanyLandingPagePreview106aFragment:APP.overlayLandingPageDesigner();break;case customCompanyLandingPage106bFragment:APP.overlayLandingPageDesigner();break;case customCompanyLandingPagePreview106bFragment:APP.overlayLandingPageDesigner();break;default:break;}
return;}
else{console.log("Marketo App > Location: Designers/Wizards");var currAssetZoneId,customCompanyEmail106Fragment="EME15464",customCompanyEmail106aFragment="EME14240",customCompanyEmail106bFragment="EME13924",loadParameters={filters:[{property:'id',value:Mkt3.DL.dl.compId}],callback:function(records){records.forEach(function(record){currAssetZoneId=record.get('zoneId');console.log("Marketo App > currAssetZoneId = "+currAssetZoneId);if(currAssetZoneId==1){APP.disableSaving();}else if(APP.getCookie("priv")=="false"){APP.disableSaving();}});}};switch(Mkt3.DL.dl.dlCompCode){case mktoEmailDesignerFragment:console.log("Callback for email editor");Ext4.getStore('Email').load(loadParameters);switch(currUrlFragment){case customCompanyEmail106Fragment:APP.overlayEmailDesigner();break;case customCompanyEmail106aFragment:APP.overlayEmailDesigner();break;case customCompanyEmail106bFragment:APP.overlayEmailDesigner();break;default:break;}
break;case mktoFormWizardFragment:console.log("Callback for form editor");Ext4.getStore('Form').load(loadParameters);break;case mktoMobilePushNotificationWizardFragment:console.log("Callback for push editor");Ext4.getStore('MobilePushNotification').load(loadParameters);break;case mktoSocialAppWizardFragment:console.log("Callback for social editor");Ext4.getStore('SocialApp').load(loadParameters);break;default:currAssetZoneId=-1;break;}}
window.onhashchange=function(){console.log("Window: Hash Changed");currentUrl=window.location.href;currUrlFragment=Mkt3.DL.getDlToken();if(currUrlFragment==mktoMyMarketoFragment){APP.overrideDeliverabilityToolsTile();}
else if(currUrlFragment==mktoMarketingActivitiesDefaultFragment||currUrlFragment==mktoLeadDatabaseDefaultFragment){APP.disableButtons();}
if(currUrlFragment.search("^"+mktoEmailDesignerFragment)==-1&&currUrlFragment.search("^"+mktoLandingPageDesignerFragment)==-1&&currUrlFragment.search("^"+mktoFormWizardFragment)==-1&&currUrlFragment.search("^"+mktoMobilePushNotificationWizardFragment)==-1&&currUrlFragment.search("^"+mktoSocialAppWizardFragment)==-1&&currUrlFragment!=mktoMyMarketoFragment){var isMktCanvasHash=window.setInterval(function(){if(MktCanvas.activeTab!==null){console.log("Marketo App > Location: Marketo Canvas");window.clearInterval(isMktCanvasHash);var currWorkspaceId=MktCanvas.activeTab.config.accessZoneId;if(currWorkspaceId==prevWorkspaceId){}
else if(currWorkspaceId==1){APP.disableSmartCampaignSaving();APP.enableSmartCampaignCanvas();APP.disableSaving();prevWorkspaceId=currWorkspaceId;}
else{if(APP.getCookie("priv")!="false"){APP.enableSmartCampaignSaving();APP.enableSaving();}
prevWorkspaceId=currWorkspaceId;}}},0);var isMktTree=window.setInterval(function(){if(typeof(Mkt.widgets.FilterTreePanel.prototype.updateTreeWidth)!=="undefined"){console.log("Marketo App > Location: Marketo Tree");window.clearInterval(isMktTree);APP.hideFolders(username);}},0);if(currUrlFragment==oppInfluenceAnalyzerFragment||currUrlFragment==programAnalyzerFragment||currUrlFragment==modeler106Fragment||currUrlFragment==modeler106abFragment||currUrlFragment==successPathAnalyzerFragment){console.log("Marketo App > Location: Analytics");APP.injectAnalyzerNavBar();}}}}
else{if(currUrlFragment==mktoMyMarketoFragment){APP.overrideDeliverabilityToolsTile();}
window.onhashchange=function(){if(currUrlFragment==mktoMyMarketoFragment){APP.overrideDeliverabilityToolsTile();}}}}},0);}